# 数据可用性层


## 所需功能

DA 层负责多项任务：

1. 确保汇总数据的可用性

2. 对汇总被迫处理的入站批次进行速率限制和优先级处理

3. 向批次发送者提供防篡改证明（只要强制执行速率限制，这是可选的）

4. 为抵制审查制度提供后盾

5. 提供链上汇总内和汇总之间批次的总排序

让我们详细了解每项任务：

### 数据可用性

Rollup 旨在允许任意状态机继承底层 L1 区块链的安全保证。为了使这些保证成立，汇总的数据必须“可用”。否则，攻击者可以通过发布包含有效但秘密状态更新的新状态根来冻结汇总。由于没有其他人知道系统的新状态，诚实的参与者将无法发布新的区块。

在 Sovereign SDK 中，我们假设底层 L1 上发布的数据可用，并且只需检查相关数据是否确实包含在 L1 历史记录中即可。 Rollup 开发人员有责任选择一条为其应用程序提供合适的数据可用性保证的链。

### 速率限制和优先级

没有一条链条具有无限的容量。因此，为了确保稳健运行，链需要确保交易可以优先排序。由于汇总上的交易创建了有用的经济活动，因此我们假设，随着时间的推移，诚实的排序器（包括“真实”交易）应该能够产生收入。他们可以用这笔收入来竞标 L1 上的区块空间。相比之下，不诚实的排序器仅发送“垃圾邮件”交易不会产生收入。对于 DOS 抵抗，至关重要的是这些不诚实的测序者不能永久“排挤”诚实的测序者。因此，在 L1 上发送交易的成本一定很高。此外，L1 上支付的费用应该与需求成正比，这样挤出诚实汇总交易的成本就会随着这些交易的价值而上升。

### 发件人认证

第一层区块链的一项未被充分认识的优势是它们能够在无效交易被纳入区块之前将其删除。由于大多数关于区块链的学术工作将点对点层抽象为一个简单的八卦网络，因此（据我们所知）尚未指出 L1 具有“超大规模”的清除无效交易的能力。换句话说，典型的 L1 抵御基于无效交易的 DOS 攻击的能力与全节点的数量成线性关系。

对区块链的一种简单的 DOS 攻击是将大量看似合理的交易提交到内存池中，所有这些交易都具有无效签名。由于签名无效，任何人都无法因垃圾邮件而在链上被收取费用。但是，由于交易看起来似乎合理，因此完整节点必须完成检查签名的工作。由于选择一些看起来像签名的随机字节比检查签名的有效性要便宜得多，因此资源受限的攻击者可以使用此方法发起相当有效的垃圾邮件攻击。

但是，L1 并不脆弱。为什么不？因为完整节点拒绝传播无效交易，所以与任何这样做的节点断开连接，并且仅以有限的速率打开新连接。这可以防止攻击者压倒单个同行，或者更糟糕的是，将他的垃圾邮件交易包含在最终分类账中。

由于 Sovereign SDK 链被设计为在包含无效交易的“惰性”账本上运行，因此默认情况下它们不会继承此属性。作为补偿，Sovereign SDK 使用了一个简单的技巧：我们通过绑定一些 (L2) 代币并声明 L1 地址的所有权来强制排序器在 L2 链上注册。使用这个技巧，我们可以将定序器签名检查卸载到 L1。在汇总级别，我们仅处理由绑定排序器（我们可以削减它们以抑制垃圾邮件）发送的批次，并且我们利用 L1 强制签名检查的事实将工作卸载到 L1 共识网络。因此，我们不是对 zk 中的每个批次进行昂贵的签名检查，而是使用更便宜的查找来检查用户是否是已注册的定序器。



### 抵制审查制度

抵制审查制度是重点。如果你的汇总没有它，它就不是 L2，只是一个闪闪发光的数据库。但是，汇总本身无法提供审查阻力 - 毕竟，底层 L1 总是可以审查包含不受欢迎交易的捆绑包。因此，L1 需要具有抗审查能力。

### 总订购量

我们允许 Sovereign SDK 链指定他们选择的任何状态模型。因此，底层 DA 层必须提供汇总批次的总排序。出于桥接的目的，它还需要在不同的汇总上提供跨批次的排序。 （只有当底层链使用 DAG 模型时，这才是问题）。未来这一要求可能会放宽。

### 可选功能

TODO：具有 Rollup 的 2 路信任最小化桥

## 所需接口

### DaSpec

该接口定义了 DaService 和 DaVerifier 特征之间共享的类型。它没有关联的功能。

### 类型： BlobTransaction
